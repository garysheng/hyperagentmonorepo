"use strict";(()=>{var oe=(t,e,_)=>new Promise((n,i)=>{var o=l=>{try{u(_.next(l))}catch(a){i(a)}},s=l=>{try{u(_.throw(l))}catch(a){i(a)}},u=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,s);u((_=_.apply(t,e)).next())});var R,v,ue,Ne,x,ie,ce,B,fe,X,J,V,Me,W={},pe=[],We=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,z=Array.isArray;function S(t,e){for(var _ in e)t[_]=e[_];return t}function G(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function C(t,e,_){var n,i,o,s={};for(o in e)o=="key"?n=e[o]:o=="ref"?i=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?R.call(arguments,2):_),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return F(t,s,n,i,null)}function F(t,e,_,n,i){var o={type:t,props:e,key:_,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i==null?++ue:i,__i:-1,__u:0};return i==null&&v.vnode!=null&&v.vnode(o),o}function q(t){return t.children}function I(t,e){this.props=t,this.context=e}function P(t,e){if(e==null)return t.__?P(t.__,t.__i+1):null;for(var _;e<t.__k.length;e++)if((_=t.__k[e])!=null&&_.__e!=null)return _.__e;return typeof t.type=="function"?P(t):null}function de(t){var e,_;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((_=t.__k[e])!=null&&_.__e!=null){t.__e=t.__c.base=_.__e;break}return de(t)}}function se(t){(!t.__d&&(t.__d=!0)&&x.push(t)&&!L.__r++||ie!==v.debounceRendering)&&((ie=v.debounceRendering)||ce)(L)}function L(){var t,e,_,n,i,o,s,u;for(x.sort(B);t=x.shift();)t.__d&&(e=x.length,n=void 0,o=(i=(_=t).__v).__e,s=[],u=[],_.__P&&((n=S({},i)).__v=i.__v+1,v.vnode&&v.vnode(n),Y(_.__P,n,i,_.__n,_.__P.namespaceURI,32&i.__u?[o]:null,s,o==null?P(i):o,!!(32&i.__u),u),n.__v=i.__v,n.__.__k[n.__i]=n,ve(s,n,u),n.__e!=o&&de(n)),x.length>e&&x.sort(B));L.__r=0}function he(t,e,_,n,i,o,s,u,l,a,f){var r,p,c,g,y,m,d=n&&n.__k||pe,h=e.length;for(l=De(_,e,d,l,h),r=0;r<h;r++)(c=_.__k[r])!=null&&(p=c.__i===-1?W:d[c.__i]||W,c.__i=r,m=Y(t,c,p,i,o,s,u,l,a,f),g=c.__e,c.ref&&p.ref!=c.ref&&(p.ref&&K(p.ref,null,c),f.push(c.ref,c.__c||g,c)),y==null&&g!=null&&(y=g),4&c.__u||p.__k===c.__k?l=me(c,l,t):typeof c.type=="function"&&m!==void 0?l=m:g&&(l=g.nextSibling),c.__u&=-7);return _.__e=y,l}function De(t,e,_,n,i){var o,s,u,l,a,f=_.length,r=f,p=0;for(t.__k=new Array(i),o=0;o<i;o++)(s=e[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(l=o+p,(s=t.__k[o]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?F(null,s,null,null,null):z(s)?F(q,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?F(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=t,s.__b=t.__b+1,u=null,(a=s.__i=Ue(s,_,l,r))!==-1&&(r--,(u=_[a])&&(u.__u|=2)),u==null||u.__v===null?(a==-1&&p--,typeof s.type!="function"&&(s.__u|=4)):a!=l&&(a==l-1?p--:a==l+1?p++:(a>l?p--:p++,s.__u|=4))):t.__k[o]=null;if(r)for(o=0;o<f;o++)(u=_[o])!=null&&!(2&u.__u)&&(u.__e==n&&(n=P(u)),ge(u,u));return n}function me(t,e,_){var n,i;if(typeof t.type=="function"){for(n=t.__k,i=0;n&&i<n.length;i++)n[i]&&(n[i].__=t,e=me(n[i],e,_));return e}t.__e!=e&&(e&&t.type&&!_.contains(e)&&(e=P(t)),_.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ue(t,e,_,n){var i,o,s=t.key,u=t.type,l=e[_];if(l===null||l&&s==l.key&&u===l.type&&!(2&l.__u))return _;if(n>(l!=null&&!(2&l.__u)?1:0))for(i=_-1,o=_+1;i>=0||o<e.length;){if(i>=0){if((l=e[i])&&!(2&l.__u)&&s==l.key&&u===l.type)return i;i--}if(o<e.length){if((l=e[o])&&!(2&l.__u)&&s==l.key&&u===l.type)return o;o++}}return-1}function ae(t,e,_){e[0]=="-"?t.setProperty(e,_==null?"":_):t[e]=_==null?"":typeof _!="number"||We.test(e)?_:_+"px"}function A(t,e,_,n,i){var o;e:if(e=="style")if(typeof _=="string")t.style.cssText=_;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)_&&e in _||ae(t.style,e,"");if(_)for(e in _)n&&_[e]===n[e]||ae(t.style,e,_[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(fe,"$1")),e=e.toLowerCase()in t||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=_,_?n?_.u=n.u:(_.u=X,t.addEventListener(e,o?V:J,o)):t.removeEventListener(e,o?V:J,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=_==null?"":_;break e}catch(s){}typeof _=="function"||(_==null||_===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&_==1?"":_))}}function le(t){return function(e){if(this.l){var _=this.l[e.type+t];if(e.t==null)e.t=X++;else if(e.t<_.u)return;return _(v.event?v.event(e):e)}}}function Y(t,e,_,n,i,o,s,u,l,a){var f,r,p,c,g,y,m,d,h,E,H,D,N,re,U,O,j,w=e.type;if(e.constructor!==void 0)return null;128&_.__u&&(l=!!(32&_.__u),o=[u=e.__e=_.__e]),(f=v.__b)&&f(e);e:if(typeof w=="function")try{if(d=e.props,h="prototype"in w&&w.prototype.render,E=(f=w.contextType)&&n[f.__c],H=f?E?E.props.value:f.__:n,_.__c?m=(r=e.__c=_.__c).__=r.__E:(h?e.__c=r=new w(d,H):(e.__c=r=new I(d,H),r.constructor=w,r.render=Fe),E&&E.sub(r),r.props=d,r.state||(r.state={}),r.context=H,r.__n=n,p=r.__d=!0,r.__h=[],r._sb=[]),h&&r.__s==null&&(r.__s=r.state),h&&w.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=S({},r.__s)),S(r.__s,w.getDerivedStateFromProps(d,r.__s))),c=r.props,g=r.state,r.__v=e,p)h&&w.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),h&&r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(h&&w.getDerivedStateFromProps==null&&d!==c&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(d,H),!r.__e&&(r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(d,r.__s,H)===!1||e.__v==_.__v)){for(e.__v!=_.__v&&(r.props=d,r.state=r.__s,r.__d=!1),e.__e=_.__e,e.__k=_.__k,e.__k.some(function(M){M&&(M.__=e)}),D=0;D<r._sb.length;D++)r.__h.push(r._sb[D]);r._sb=[],r.__h.length&&s.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(d,r.__s,H),h&&r.componentDidUpdate!=null&&r.__h.push(function(){r.componentDidUpdate(c,g,y)})}if(r.context=H,r.props=d,r.__P=t,r.__e=!1,N=v.__r,re=0,h){for(r.state=r.__s,r.__d=!1,N&&N(e),f=r.render(r.props,r.state,r.context),U=0;U<r._sb.length;U++)r.__h.push(r._sb[U]);r._sb=[]}else do r.__d=!1,N&&N(e),f=r.render(r.props,r.state,r.context),r.state=r.__s;while(r.__d&&++re<25);r.state=r.__s,r.getChildContext!=null&&(n=S(S({},n),r.getChildContext())),h&&!p&&r.getSnapshotBeforeUpdate!=null&&(y=r.getSnapshotBeforeUpdate(c,g)),u=he(t,z(O=f!=null&&f.type===q&&f.key==null?f.props.children:f)?O:[O],e,_,n,i,o,s,u,l,a),r.base=e.__e,e.__u&=-161,r.__h.length&&s.push(r),m&&(r.__E=r.__=null)}catch(M){if(e.__v=null,l||o!=null)if(M.then){for(e.__u|=l?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;o[o.indexOf(u)]=null,e.__e=u}else for(j=o.length;j--;)G(o[j]);else e.__e=_.__e,e.__k=_.__k;v.__e(M,e,_)}else o==null&&e.__v==_.__v?(e.__k=_.__k,e.__e=_.__e):u=e.__e=Ae(_.__e,e,_,n,i,o,s,l,a);return(f=v.diffed)&&f(e),128&e.__u?void 0:u}function ve(t,e,_){for(var n=0;n<_.length;n++)K(_[n],_[++n],_[++n]);v.__c&&v.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){v.__e(o,i.__v)}})}function Ae(t,e,_,n,i,o,s,u,l){var a,f,r,p,c,g,y,m=_.props,d=e.props,h=e.type;if(h=="svg"?i="http://www.w3.org/2000/svg":h=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(a=0;a<o.length;a++)if((c=o[a])&&"setAttribute"in c==!!h&&(h?c.localName==h:c.nodeType==3)){t=c,o[a]=null;break}}if(t==null){if(h==null)return document.createTextNode(d);t=document.createElementNS(i,h,d.is&&d),u&&(v.__m&&v.__m(e,o),u=!1),o=null}if(h===null)m===d||u&&t.data===d||(t.data=d);else{if(o=o&&R.call(t.childNodes),m=_.props||W,!u&&o!=null)for(m={},a=0;a<t.attributes.length;a++)m[(c=t.attributes[a]).name]=c.value;for(a in m)if(c=m[a],a!="children"){if(a=="dangerouslySetInnerHTML")r=c;else if(!(a in d)){if(a=="value"&&"defaultValue"in d||a=="checked"&&"defaultChecked"in d)continue;A(t,a,null,c,i)}}for(a in d)c=d[a],a=="children"?p=c:a=="dangerouslySetInnerHTML"?f=c:a=="value"?g=c:a=="checked"?y=c:u&&typeof c!="function"||m[a]===c||A(t,a,c,m[a],i);if(f)u||r&&(f.__html===r.__html||f.__html===t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(r&&(t.innerHTML=""),he(t,z(p)?p:[p],e,_,n,h=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:_.__k&&P(_,0),u,l),o!=null)for(a=o.length;a--;)G(o[a]);u||(a="value",h=="progress"&&g==null?t.removeAttribute("value"):g!==void 0&&(g!==t[a]||h=="progress"&&!g||h=="option"&&g!==m[a])&&A(t,a,g,m[a],i),a="checked",y!==void 0&&y!==t[a]&&A(t,a,y,m[a],i))}return t}function K(t,e,_){try{if(typeof t=="function"){var n=typeof t.__u=="function";n&&t.__u(),n&&e==null||(t.__u=t(e))}else t.current=e}catch(i){v.__e(i,_)}}function ge(t,e,_){var n,i;if(v.unmount&&v.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||K(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){v.__e(o,e)}n.base=n.__P=null}if(n=t.__k)for(i=0;i<n.length;i++)n[i]&&ge(n[i],e,_||typeof t.type!="function");_||G(t.__e),t.__c=t.__=t.__e=void 0}function Fe(t,e,_){return this.constructor(t,_)}function Q(t,e,_){var n,i,o,s;e==document&&(e=document.documentElement),v.__&&v.__(t,e),i=(n=typeof _=="function")?null:_&&_.__k||e.__k,o=[],s=[],Y(e,t=(!n&&_||e).__k=C(q,null,[t]),i||W,W,e.namespaceURI,!n&&_?[_]:i?null:e.firstChild?R.call(e.childNodes):null,o,!n&&_?_:i?i.__e:e.firstChild,n,s),ve(o,t,s)}R=pe.slice,v={__e:function(t,e,_,n){for(var i,o,s;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,n||{}),s=i.__d),s)return i.__E=i}catch(u){t=u}throw t}},ue=0,Ne=function(t){return t!=null&&t.constructor==null},I.prototype.setState=function(t,e){var _;_=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=S({},this.state),typeof t=="function"&&(t=t(S({},_),this.props)),t&&S(_,t),t!=null&&this.__v&&(e&&this._sb.push(e),se(this))},I.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),se(this))},I.prototype.render=q,x=[],ce=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,B=function(t,e){return t.__v.__b-e.__v.__b},L.__r=0,fe=/(PointerCapture)$|Capture$/i,X=0,J=le(!1),V=le(!0),Me=0;var ee,b,Z,ye,te=0,xe=[],k=v,be=k.__b,ke=k.__r,Ce=k.diffed,we=k.__c,Ee=k.unmount,He=k.__;function Ie(t,e){k.__h&&k.__h(b,t,te||e),te=0;var _=b.__H||(b.__H={__:[],__h:[]});return t>=_.__.length&&_.__.push({}),_.__[t]}function T(t){return te=1,Le(Pe,t)}function Le(t,e,_){var n=Ie(ee++,2);if(n.t=t,!n.__c&&(n.__=[_?_(e):Pe(void 0,e),function(u){var l=n.__N?n.__N[0]:n.__[0],a=n.t(l,u);l!==a&&(n.__N=[a,n.__[1]],n.__c.setState({}))}],n.__c=b,!b.u)){var i=function(u,l,a){if(!n.__c.__H)return!0;var f=n.__c.__H.__.filter(function(p){return!!p.__c});if(f.every(function(p){return!p.__N}))return!o||o.call(this,u,l,a);var r=n.__c.props!==u;return f.forEach(function(p){if(p.__N){var c=p.__[0];p.__=p.__N,p.__N=void 0,c!==p.__[0]&&(r=!0)}}),o&&o.call(this,u,l,a)||r};b.u=!0;var o=b.shouldComponentUpdate,s=b.componentWillUpdate;b.componentWillUpdate=function(u,l,a){if(this.__e){var f=o;o=void 0,i(u,l,a),o=f}s&&s.call(this,u,l,a)},b.shouldComponentUpdate=i}return n.__N||n.__}function Re(){for(var t;t=xe.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach($),t.__H.__h.forEach(_e),t.__H.__h=[]}catch(e){t.__H.__h=[],k.__e(e,t.__v)}}k.__b=function(t){b=null,be&&be(t)},k.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),He&&He(t,e)},k.__r=function(t){ke&&ke(t),ee=0;var e=(b=t.__c).__H;e&&(Z===b?(e.__h=[],b.__h=[],e.__.forEach(function(_){_.__N&&(_.__=_.__N),_.i=_.__N=void 0})):(e.__h.forEach($),e.__h.forEach(_e),e.__h=[],ee=0)),Z=b},k.diffed=function(t){Ce&&Ce(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(xe.push(e)!==1&&ye===k.requestAnimationFrame||((ye=k.requestAnimationFrame)||qe)(Re)),e.__H.__.forEach(function(_){_.i&&(_.__H=_.i),_.i=void 0})),Z=b=null},k.__c=function(t,e){e.some(function(_){try{_.__h.forEach($),_.__h=_.__h.filter(function(n){return!n.__||_e(n)})}catch(n){e.some(function(i){i.__h&&(i.__h=[])}),e=[],k.__e(n,_.__v)}}),we&&we(t,e)},k.unmount=function(t){Ee&&Ee(t);var e,_=t.__c;_&&_.__H&&(_.__H.__.forEach(function(n){try{$(n)}catch(i){e=i}}),_.__H=void 0,e&&k.__e(e,_.__v))};var Se=typeof requestAnimationFrame=="function";function qe(t){var e,_=function(){clearTimeout(n),Se&&cancelAnimationFrame(e),setTimeout(t)},n=setTimeout(_,100);Se&&(e=requestAnimationFrame(_))}function $(t){var e=b,_=t.__c;typeof _=="function"&&(t.__c=void 0,_()),b=e}function _e(t){var e=b;t.__c=t.__(),b=e}function Pe(t,e){return typeof e=="function"?e(t):e}function Te({celebrityId:t,theme:e}){let[_,n]=T(!1),[i,o]=T([{type:"system",content:`Hi! Tell us about your proposal. Please include:
- Your background
- Project details
- Goals and timeline`}]),[s,u]=T(""),[l,a]=T(""),[f,r]=T(!1),p=y=>oe(this,null,function*(){if(y.preventDefault(),!(!l.trim()||f)){r(!0),o(m=>[...m,{type:"user",content:l}]),a("");try{let m={celebrityId:t,email:s,message:l};console.log("Sending request with payload:",m);let d=yield fetch("/api/widget/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!d.ok){let h=d.headers.get("content-type"),E;throw h!=null&&h.includes("application/json")?E=(yield d.json()).error||`Request failed with status ${d.status}`:E=`Request failed with status ${d.status}`,new Error(E)}o(h=>[...h,{type:"system",content:"Thanks for your message! We'll review it and get back to you if there's a good fit."}])}catch(m){console.error("Error sending message:",m),o(d=>[...d,{type:"system",content:m instanceof Error?m.message:"Sorry, there was an error sending your message. Please try again."}])}finally{r(!1)}}}),c=y=>{u(y.currentTarget.value)},g=y=>{a(y.currentTarget.value)};return C("div",null,C("button",{className:"chat-button",onClick:()=>n(!_),style:{backgroundColor:e.primaryColor,transform:"scaleX(-1)"}},"\u{1F4AC}"),_&&C("div",{className:"chat-window"},C("div",{className:"chat-header"},C("h3",null,"Chat with HyperAgent"),C("button",{onClick:()=>n(!1)},"\u2715")),C("div",{className:"chat-messages"},i.map((y,m)=>C("div",{key:m,className:`message ${y.type}`},y.content))),C("form",{onSubmit:p,className:"chat-form"},C("div",{className:`email-input-container ${s?"hidden":""}`},C("input",{type:"email",placeholder:"Your email",value:s,onChange:c,required:!s})),C("div",{className:"message-input"},C("textarea",{placeholder:"Type your message...",value:l,onChange:g,rows:3,required:!0}),C("button",{type:"submit",disabled:f||!s,style:{backgroundColor:e.primaryColor}},f?"...":"\u2192")))))}var ne=class{init(e){this.config=e,this.root=document.createElement("div"),this.config.container.appendChild(this.root),console.log("Widget config:",e),Q(C(Te,{celebrityId:this.config.celebrityId,theme:this.config.theme}),this.root)}destroy(){this.root&&Q(null,this.root)}};window.HyperAgentWidget=new ne;})();
